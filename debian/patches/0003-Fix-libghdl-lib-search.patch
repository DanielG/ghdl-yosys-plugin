--- a/Makefile
+++ b/Makefile
@@ -8,10 +8,10 @@ SOEXT=so
 
 CFLAGS ?= -O
 
-LIBGHDL_LIB:=$(shell $(GHDL) --libghdl-library-path)
+LIBGHDL_LIB:=$(shell $(GHDL) --libghdl-name)
 LIBGHDL_INC:=$(shell $(GHDL) --libghdl-include-dir)
 
-ALL_LDFLAGS=$(LIBGHDL_LIB) -Wl,-rpath,$(dir $(LIBGHDL_LIB)) $(LDFLAGS)
+ALL_LDFLAGS=-l$(basename $(LIBGHDL_LIB:lib%=%))
 PLUGINDIR:=$(shell $(YOSYS_CONFIG) --datdir)/plugins
 
 ALL_CFLAGS=-fPIC -DYOSYS_ENABLE_GHDL -I$(LIBGHDL_INC) $(CFLAGS)
